Dieses Kapitel widmet sich der Frage, ob und wie man aus der Menge aller Eigenpaare
des Problems
\[
Ax = \lambda Bx
\]
eine gew"unschte Teilmenge ausw"ahlen kann. Dazu werden im Rahmen dieser Arbeit aus dem Katalog der Verfahren
die zwei folgenden ausgew"ahlt und vorgestellt: Projektionsverfahren und Konturintegration.
Ob ein Zusammenhang zwischen beiden Konzepten besteht, wird im n"achsten Kapitel gekl"art.\\

%Ein M"oglicheit das eingangs geschilderte Eigenwertproblem zu l"osen, ist
%das Anwenden einer Klasse von Verfahren, die sich \emph{Rayleigh-Ritz-Verfahren}
%nennen. Die Idee besteht darin die Eigenr"aume/ den Eigenraum \textcolor{red}{(was nun genau? bekomme ich alle
%Eigenr"aume? nur einegn? was genau approximiere ich?)} durch eine Folge von Unterr"aumen
%zu approximieren, die durch orthogonale Projektionen konstruiert werden.\textcolor{red}{was ist genau
%mit approximieren gemeint? in welchem sinne? und ist das "uberhaupt korrekt?} In diesem
%Abschnitt wird die mathematische Idee dieser Projektionsverfahren vorgestellt und
%die Verwendung von Filtern motiviert \textcolor{red}{kam die motivation nicht schon
%in der einleitung?}

\section{Projektionsverfahren}
%\footnote{Dieser Abschnitt orientiert sich in Formulierung und Dramaturgie an Abschnitt 4.3.1 aus Y. Saad Solving large evp. Hier verallgemeinern wir aber die Konzepte direkt auf allg. ewp.}
Eine \textcolor{red}{Die?} Idee dieser Klasse von Verfahren ist das Approximieren des von
den gesuchten Eigenvektoren aufgespannten Unterraums. Dazu sollen -- wie der Name vermuten l"asst --
Projektionen bem"uht werden.\\

Bevor wir das allgemeine Eigenproblem untersuchen, wenden wir unsere Aufmerksamkeit
dem gew"ohnlichen Eigenproblem
\[
Ax = \lambda x% \textcolor{red}{variablen wieder neu einf"uhren? oder in der einleitung: im folgenden sei stets...}
\]
zu und betrachten f"ur eine Zahl $m\in\N$ mit $m\le n$
einen $m$-dimensionalen Unterraum $\U_m\subseteq\Cn$. Dieser zun"achst nicht
n"aher bestimmte \emph{Suchraum} wird als Grundlage f"ur das Projektionsverfahren gew"ahlt.
Gesucht sind nun Paare $(\widetilde{\lambda}, \widetilde{x})\in\C\times \U_m \setminus\{0\}$ --
die wir als approximierte L"osungen des Eigenproblems verstehen wollen --
welche die Eigenschaft
\begin{equation}\label{eq:orthogonal}
\langle u, A\widetilde{x} - \widetilde{\lambda}\widetilde{x} \rangle=0
\end{equation}
f"ur alle $u \in \U_m $ erf"ullen. Das Residuum $A\widetilde{x} - \widetilde{\lambda}\widetilde{x}$
soll also orthogonal auf dem Suchraum stehen. Paare, die diesem Anliegen nachkommen,
werden auch \emph{Ritz-Paare} bez"uglich des Suchraums $\U_m$ genannt.\\

Wir wollen nun annehmen, dass mit der Menge von Vektoren $\{u_i\}_{i=1:m}\subseteq \Cn$ eine Orthonormalbasis
des Unterraums $\U_m$ gegeben ist. Dann l"asst sich die Forderung \eqref{eq:orthogonal} wie folgt
umschreiben: Mit Hilfe der Matrix
$U_m :=[u_i]_{i=1:m}\in\C^{n,m}$ und einem geeigneten Vektor $y\in\C^m$ erhalten wir
mit der Substitution $U_m y = \widetilde{x}$ das Gleichungssystem
\[
U_m^H(AU_m y - \widetilde{\lambda} U_m y) = 0.
\]
Dieses f"uhrt unter Ausnutzung der Orthogonalit"at der Spalten von $U_m$ mit%als direkte Konsequenz dieser Substitution erhalten wir unter Ausnutzung der Orthogonalit"at der Spalten von $V_m$ mit
\begin{equation}\label{eq:transform}
(U_m^H A U_m) y = \widetilde{\lambda}y.
\end{equation}
zu einem neuen Eigenwertproblem. Jedes Eigenpaar $(\widetilde{\lambda},y)$ von \eqref{eq:transform}
liefert dann nach Konstruktion mit $(\widetilde{\lambda}, U_m y)$ ein Ritz-Paar des gew"ohnlichen
Eigenproblems bez"uglich des Suchraums $\U_m$. Demnach h"angt von der Wahl
des Suchraumes ab, ob und wie gut die gew"unschen Eigenpaare approximiert werden.
Wir werden sp"ater aus den Untersuchungen des allgemeinen Eigenwertproblems folgern,
dass im Falle der Invarianz von $\U_m$ unter $A$ jedes Ritz-Paar von $A$ sogar ein Eigenpaar ist.
An dieser Stelle begn"ugen wir uns schlicht mit dieser erfreulichen Botschaft.\\

Fassen wir die eben geschilderte Vorgehensweise algorithmisch zusammen, so ist
der folgende Pseudocode denkbar:
\textcolor{red}{
\begin{itemize}
\item do stuff
\item do further stuff
\item stuff stuff stuff
\item finish the stuff
\end{itemize}}

Doch wozu dient die M"uhe, das urspr"ungliche Eigenwertproblem in ein anderes
Eigenwertproblem zu "uberf"uhren? Zwar gelingt es, aus dem transformierten Problem
\eqref{eq:transform} Ritz-Paare zu extrahieren, aber w"are nicht auch denkbar,
s"amtliche Eigenpaare von $A$ zu approximieren und die gew"unschte Teilmenge
direkt auszuw"ahlen?\\

Dies mag in Einzelf"allen in der Tat sinnvoller sein. Sprechen wir allerdings
von Matrixdimensionen jenseits der Vorstellungskraft, ist eine vollst"andige
Berechnung aller Eigenpaare mitunter ein sehr zeitintensives Vergn"ugen. Bei
genauerer Betrachtung der Gleichung \eqref{eq:transform} f"allt auf, dass die
Matrix $(U_m^H A U_m) \in \C^{m,m}$ im Falle $n \gg m$ ein mitunter deutlich kleineres
Format hat, als die Matrix $A$ im urspr"unglichen Problem. Man darf hier also erwarten,
dass die ben"otigte Laufzeit zur Bestimmung der Ritz-Paare mit dem Algorithmus \textcolor{red}{(XXX)}
geringer ist, als beim Approximieren s"amtlicher Eigenpaare von $A$.

\begin{lstlisting}[caption = Rayleigh-Ritz-Verfahren (Vgl. Saad Algo. 4.5), captionpos=b]
Berechne eine ONB {v1,...,vm} von V und setze Vm = [v1,...,vm]
Berechne Eigenwerte von Vm^H * A * Vm und wähle die gewünschten aus
Berechne die zu den eben ermittelten Eigenwerte zugehörigen EVektoren
Berechne die Ritz Paare
\end{lstlisting}

Die folgende Proposition weist nach, dass der eben vorgestellte Algorithmus tats"achlich
ein Projektionsverfahren ist.

\begin{prop}\label{prop:projektor}
Die durch die Matrix $V_m V_m^H \in \Cnn$ induzierte lineare Abbildung
\[
P\colon \Cn \to \Cn, x\mapsto V_m V_m^H x
\]
ist eine orthogonale Projektion auf den Unterraum V und l"ost das Minimierungsproblem
\[
\min_{y\in V}\|x-y\|, x\in\Cn (\|x-P(x)\| = ...)
\]
\end{prop}

\begin{proof}
Sei $x\in\Cn$ vorgegeben. Dann gilt $P(x) = V_m V_m^H x \in \Bild(V_m) = V$ nach Konstruktion.
Da aus der Orthogonalit"at der Spalten von $V_m$
\[
P^2 = V_m V_m^H V_m V_m^H = V_m V_m^H = P
\]
folgt, ist $P$ somit eine Projektion auf $V$. Dar"uber hinaus gilt f"ur alle
Vektoren $y\in V$
\[
\langle y, x-P(x)\rangle = y^H (x - V_m V_m^H x) = y^H x - P(y)^H x = 0
\]
Also ist $x-P(x) \in V^{\bot}$ und $P$ tats"achlich eine orthogonale Projektion.
Wegen $P(x)-y \in V$ folgt die Minimalit"at aus der Absch"atzung
\begin{align*}
\|x-y\|^2 &= \|x-P(x) + P(x)-y\|^2 \\
&= \langle x-P(x) + P(x)-y, x-P(x) + P(x)-y \rangle \\
&= \|x-P(x)\|^2 + \langle x-P(x), P(x)-y \rangle + \langle P(x)-y, x-P(x)\rangle + \|P(x)-y\|^2 \\
&= \|x - P(x)\|^2 + \| P(x)-y \|^2\\
&\ge \|x-P(x)\|^2.
\end{align*}
Damit ist die Behauptung bewiesen, da Gleichheit nur mit $y=P(x)$ folgen kann.
\end{proof}

Wir wollen nun die eben erarbeitete Theorie auf das verallgemeinerte Eigenwertproblem
\[
Ax = \lambda Bx
\]
"ubertragen. Dabei gehen wir ganz analog zum gew"ohnlichen Eigenwertproblem vor.
Es sei daher wieder $\mathcal{V}_m\subseteq \Cn$ ein $m$-dimensionaler Suchraum.
Dann suchen wir wie oben Paare $ (\widetilde{\lambda}, \widetilde{x}) \in \C
\times \mathcal{V}_m \setminus\{ 0\}$ die nun der Orthogonalit"atsbedingung
\begin{equation}\label{eq:borthogonal}
A\widetilde{x} - \widetilde{\lambda}B\widetilde{x} \ \bot \ \mathcal{V}_m
\end{equation}
gen"ugen sollen. Wieder substituieren wir $V_m y=\widetilde{x}$ und erhalten die
zu \eqref{eq:borthogonal} "aquivalente Forderung
\[
V_m^H(AV_m y - \widetilde{\lambda} BV_m y) = 0.
\]
Schlie"slich l"osen wir das transformierte allgemeine Eigenwertproblem
\begin{equation}\label{eq:transformedevp}
(V_m^H AV_m) y = \widetilde{\lambda} (V_m^H B V_m) y.
\end{equation}
Jede L"osung $(\widetilde{\lambda}, y)$ von \eqref{eq:transformedevp} liefert
dann mit $(\widetilde{\lambda}, V_m y)$ ein Ritzpaar. Eine algorithmische Umsetzung
\textcolor{red}{erwartet man hier jetzt echte code oder ist pseudocode ok?}
kann dann wie folgt verallgemeinern

\begin{lstlisting}[caption = Verallgemeinertes Rayleigh-Ritz-Verfahren (Vgl. ~\cite{ptep} Algorithmus A\text{,} S. 356 \textcolor{red}{wie richtig angeben?}), captionpos=b]
blubbblubb
blubbblubb
\end{lstlisting}

Nun verallgemeinern wir das Resultat \ref{prop:projektor}.

\begin{prop}
Sei $B$ eine HPD-Matrix und $V_m$ habe $B$-orthogonale Vektoren aus $\mathcal{V}$,
das hei"st, es gelte $V_m^H B V_m = I_m$.
Die durch die Matrix $V_m V_m^H B \in \Cnn$ induzierte lineare Abbildung
\[
P_B \colon \Cn \to \Cn, x\mapsto V_m V_m^H Bx
\]
ist eine $B$-orthogonale Projektion auf den Unterraum $\mathcal{V}$ und l"ost das Minimierungsproblem
\[
\min_{y\in\mathcal{V}} \|x - y\|_B, x\in\Cn.
\]
\end{prop}

\begin{proof}
Der Beweis geht ganz analog zu $\ref{prop:projektor}$. Es gilt
\[
P_B^2 = V_m \underbrace{V_m^H B V_m}_{=I_m} V_m^H B = V_m V_m^H B = P_B
\]
und $P_B(\Cn) = \mathcal{V}$ folgt nach Konstruktion ($\Rang{P_B} = \dim(\mathcal{V})$). Ist nun $y\in\mathcal{V}$
und $x\in\Cn$, dann folgt wegen $P_B (y) = y$ und $B=B^H$ auch
\begin{align*}
\langle y, x-P_B(x)\rangle_B &= y^H (Bx - B V_m V_m^H Bx) \\
&= y^H (Bx - B^H V_m V_m^H Bx) \\
&= y^H Bx - P_B(y)^H Bx = 0.
\end{align*}
Es gilt demnach $x-P_B(x) \ \bot_B \ \mathcal{V}$. Schlie"slich gilt
\[
\|x-y\|_B^2 = \|x-P(x) + P(x)-y\|_B^2 = \|x-P(x)\|_B^2 + \|P(x)-y\|_B^2
\ge \|x-P(x)\|_B^2
\]
mit Gleichheit genau dann, wenn $P(x)=x$ erf"ullt ist.
\end{proof}


Auf diesen "Uberlegungen aufbauend, l"asst sich nun das folgende Verfahren konstruieren.
blabla saad... s. 98.

%\section{Analytische Konstruktion des Spektralprojektors}

\section{Konturintegration}
Das Filtern von Eigenpaaren durch Integration "uber komplexe Kurven scheint
zun"achst nicht sehr naheliegend. Wie ist der Zusammenhang
